<div class="container py-4">

  <!-- HEADER -->
  <header class="mb-4">
    <div class="d-flex justify-content-between align-items-baseline">
      <div>
        <h1 class="h3 mb-1">Admin Dashboard</h1>
        <p class="text-muted mb-0">Manage products (Add / Edit / Delete)</p>
      </div>

      <div class="text-end small text-muted">
        Logged in as Admin: <span class="fw-semibold">admin@example.com</span>
      </div>
    </div>
  </header>

  <!-- TOP ACTIONS BAR -->
  <section class="d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3">
    <div>
      <button
        type="button"
        class="btn btn-primary"
        (click)="onAddProduct()"
      >
        + Add New Product
      </button>
    </div>

    <div class="d-flex align-items-center gap-2">
      <label for="productSearch" class="mb-0 small text-muted">Search:</label>
      <input
        id="productSearch"
        type="text"
        class="form-control form-control-sm"
        style="min-width: 220px;"
        placeholder="Search by name or category"
        name="searchTerm"
        [(ngModel)]="searchTerm"
      />
    </div>
  </section>

  <!-- ADD / EDIT PRODUCT FORM -->
  <section *ngIf="showForm" class="mb-3">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title mb-3">
          {{ isEditing ? 'Edit Product' : 'Add New Product' }}
        </h5>

        <form (ngSubmit)="onSubmitProductForm()">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Name</label>
              <input
                type="text"
                class="form-control"
                name="name"
                [(ngModel)]="formData.name"
                required
              />
            </div>

            <div class="col-md-3">
              <label class="form-label">Price</label>
              <input
                type="number"
                class="form-control"
                name="price"
                [(ngModel)]="formData.price"
                required
              />
            </div>

            <div class="col-md-3">
              <label class="form-label">Stock</label>
              <input
                type="number"
                class="form-control"
                name="stock"
                [(ngModel)]="formData.stock"
                required
              />
            </div>

            <div class="col-md-6">
              <label class="form-label">Category</label>
              <input
                type="text"
                class="form-control"
                name="category"
                [(ngModel)]="formData.category"
              />
            </div>
          </div>

          <div class="mt-3 d-flex justify-content-end gap-2">
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="onCancelForm()"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-success">
              {{ isEditing ? 'Save Changes' : 'Create Product' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- PRODUCTS TABLE -->
  <section>
    <div class="table-responsive shadow-sm rounded-3 bg-white">
      <table class="table table-hover mb-0 align-middle">
        <thead class="table-light">
          <tr>
            <th scope="col">#ID</th>
            <th scope="col">Name</th>
            <th scope="col">Price</th>
            <th scope="col">Category</th>
            <th scope="col">Stock</th>
            <th scope="col" class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- use filteredProducts so search works -->
          <tr *ngFor="let product of filteredProducts; let i = index">
            <td>{{ product.id || (i + 1) }}</td>
            <td>{{ product.name }}</td>
            <td>₹{{ product.price }}</td>
            <td>{{ product.category }}</td>
            <td>{{ product.stock }}</td>
            <td class="text-end">
              <button
                type="button"
                class="btn btn-sm btn-outline-secondary me-2"
                (click)="onEditProduct(product)"
              >
                Edit
              </button>
              <button
                type="button"
                class="btn btn-sm btn-outline-danger"
                (click)="onDeleteProduct(product)"
              >
                Delete
              </button>
            </td>
          </tr>

          <tr *ngIf="!filteredProducts || filteredProducts.length === 0">
            <td colspan="6" class="text-center text-muted py-4">
              No products found. Click <strong>“Add New Product”</strong> to create one.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

</div>
